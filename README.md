# README

## System requirement:

1. Python3.11
2. mkcert

## Install related python library

```
pip install -r requirements.txt
```

## Create SSL certificate

### Install the local CA in the system trust store

```
brew install mkcert

mkcert -install
```

### Create certificate

```
mkcert -key-file key.pem -cert-file cert.pem www.svc.deltaww-energy.com www.svc-a.deltaww-energy.com www.svc-b.deltaww-energy.com saml-spa.deltaww-energy.com saml-spb.deltaww-energy.com
```

Place the `key.pem` and `cert.pem` generated by mkcert into the `ca` folder in the project directory.

### Setup self-signed domain name

```
sudo su
echo "127.0.0.1 www.svc.deltaww-energy.com
127.0.0.1 www.svc-a.deltaww-energy.com
127.0.0.1 www.svc-b.deltaww-energy.com
127.0.0.1 saml-spa.deltaww-energy.com
127.0.0.1 saml-spb.deltaww-energy.com" >> /etc/hosts
```

### Start services

```bash
# OAuth server and SAML server
# https://www.svc.deltaww-energy.com:5001/sso/oauth
# https://www.svc.deltaww-energy.com:5001/sso/saml/login
python -m sso_server.start
# OAuth clients
# https://www.svc-a.deltaww-energy.com:5002/
python -m sso_client.service_a
# https://www.svc-b.deltaww-energy.com:5003/
python -m sso_client.service_b
# SAML clients
# https://saml-spa.deltaww-energy.com:9000/
python -m sso_client.saml_spa
# https://saml-spb.deltaww-energy.com:9001/
python -m sso_client.saml_spb
```

## Description of protocal and API

### SAML 2.0 API and machinsm

https://documenter.getpostman.com/view/31493157/2s9Ykhhjuh

All API doc is written in postman document

### OAUTH 2.0 API and machinsm

https://documenter.getpostman.com/view/31493157/2s9YkjAPBq

### About RBAC

https://www.svc-a.deltaww-energy.com:5002/openapi
https://www.svc-b.deltaww-energy.com:5003/openapi
